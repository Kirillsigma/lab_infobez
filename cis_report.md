# Отчёт по аудиту CIS

**ФИО:** Мелешко Кирилл Николаевич  
**Вариант:** 13  
**Дисциплина:** Информационная безопасность

**Итог:** реализовано 15 проверок из 15(PASS: 8, FAIL: 7, ERROR: 0; NOT_IMPLEMENTED: 0).

| № | Control ID | Статус | Название |
|---:|:---------:|:------:|:---------|
| 1 | 17.6.1 | PASS | Аудит: Detailed File Share включает 'Failure' |
| 2 | 2.3.1.5 | FAIL | Переименование гостевой учетной записи |
| 3 | 2.3.11.7 | PASS | Сетевая безопасность: уровень проверки подлинности LAN Manager |
| 4 | 2.3.11.7 | PASS | Сетевой доступ: ограничить клиентов, которым разрешено выполнять удаленные вызовы SAM |
| 5 | 18.10.75.2.1 | PASS | Настройка Windows Defender SmartScreen |
| 6 | 18.10.56.3.3.2 | PASS | Не разрешать перенаправление COM-портов |
| 7 | 5.19 | FAIL | Поддержка панели управления отчетов о проблемах и их решений (wercplsupport) |
| 8 | 18.9.20.1.6 | FAIL | Отключить загрузку из Интернета для мастеров веб-публикации и онлайн-заказов |
| 9 | 5.11 | FAIL | Обеспечение настройки «Служба Microsoft FTP (FTPSVC)» в значение «Отключено» или «Не установлено» |
| 10 | 18.5.11 | FAIL |  Обеспечение настройки «MSS: (TcpMaxDataRetransmissions IPv6) Сколько раз повторно передаются неподтвержденные данные» в значение «Включено: 3» |
| 11 | 18.10.92.4.1 | FAIL | Обеспечение настройки «Управление сборками предварительной оценки» в значение «Отключено» |
| 12 | 9.3.9 | PASS | Обеспечение настройки «Брандмауэр Windows: Общедоступная: Ведение журнала: Регистрировать успешные подключения» в значение «Да» |
| 13 | 18.10.9.3.11 | PASS | Обеспечение настройки «Настройка использования паролей для съемных дисков данных» |
| 14 | 18.9.4.2 | FAIL | Обеспечение настройки «Удаленный узел разрешает делегирование неэкспортируемых учетных данных» в значение «Включено» |
| 15 | 18.10.9.2.5 | PASS | Обеспечение настройки «Выбор способа восстановления защищенных BitLocker дисков операционной системы: Пароль восстановления» в значение «Включено |

---

## 1. 17.6.1 — Аудит: Detailed File Share включает 'Failure'
- **Статус:** PASS
- **Ожидается:** Включает Сбой
- **Фактически:** `Сбой включен`
- **Ссылка:** auditpol /get /subcategory:"Detailed File Share" → Setting: Failure (или Success and Failure)
- **Описание:** Ведёт аудит попыток доступа к файлам и папкам на общих ресурсах (события вроде 5145).
- **Обоснование:** Фиксация неудачных попыток помогает расследовать попытки несанкционированного доступа.

## 2. 2.3.1.5 — Переименование гостевой учетной записи
- **Статус:** FAIL
- **Ожидается:** Имя отличное от 'Guest'
- **Фактически:** `Текущее имя: 'Гость'`
- **Ссылка:** HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\NewGuestName
- **Описание:** Accounts: Rename guest account = переименовано
- **Обоснование:** Защита от угадывания стандартного имени учетной записи.

## 3. 2.3.11.7 — Сетевая безопасность: уровень проверки подлинности LAN Manager
- **Статус:** PASS
- **Ожидается:** 5 (Send NTLMv2 response only. Refuse LM & NTLM)
- **Фактически:** `Текущее значение: 5 (требуется: 5)`
- **Ссылка:** HKLM\SYSTEM\CurrentControlSet\Control\Lsa\LmCompatibilityLevel
- **Описание:** Определяет протокол аутентификации для сетевых входов
- **Обоснование:** Защита от слабых протоколов аутентификации LM и NTLM

## 4. 2.3.11.7 — Сетевой доступ: ограничить клиентов, которым разрешено выполнять удаленные вызовы SAM
- **Статус:** PASS
- **Ожидается:** O:BAG:BAD:(A;;RC;;;BA)
- **Фактически:** `Текущее значение: O:BAG:BAD:(A;;RC;;;BA)`
- **Ссылка:** HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RestrictRemoteSAM
- **Описание:** Определяет протокол аутентификации для сетевых входов
- **Обоснование:** Защита от пользователей----

## 5. 18.10.75.2.1 — Настройка Windows Defender SmartScreen
- **Статус:** PASS
- **Ожидается:** 1 и Block
- **Фактически:** `Текущее значение: 1 и Block`
- **Ссылка:** SOFTWARE\Policies\Microsoft\Windows\System
- **Описание:** Windows Defender SmartScreen помогает обеспечивать безопасность ПК
- **Обоснование:** Предупреждая пользователей перед запуском нераспознанных программ, загруженных из Интернета

## 6. 18.10.56.3.3.2 — Не разрешать перенаправление COM-портов
- **Статус:** PASS
- **Ожидается:** 1 (Заблокировано)
- **Фактически:** `Текущее значение: 1`
- **Ссылка:** HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\fDisableCom
- **Описание:** Блокирует перенаправление данных на COM-порты клиента в RDP-сессиях
- **Обоснование:** Уменьшение поверхности атаки и предотвращение эксфильтрации данных

## 7. 5.19 — Поддержка панели управления отчетов о проблемах и их решений (wercplsupport)
- **Статус:** FAIL
- **Ожидается:** 4 (остановлено)
- **Фактически:** `Текущее значение: 3`
- **Ссылка:** HKLM\SYSTEM\CurrentControlSet\Services\wercplsupport:Start
- **Описание:** Эта служба обеспечивает поддержку просмотра, отправки и удаления системных отчетов о проблемах для панели управления Отчеты о проблемах и их решения
- **Обоснование:** Эта служба участвует в процессе отображения/отправки проблем и решений в/из Microsoft

## 8. 18.9.20.1.6 — Отключить загрузку из Интернета для мастеров веб-публикации и онлайн-заказов
- **Статус:** FAIL
- **Ожидается:** 1 (включено)
- **Фактически:** `Параметр NoWebServices не найден в реестре (используется значение по умолчанию - разрешено)`
- **Ссылка:** HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer:NoWebServices
- **Описание:** Этот параметр политики управляет тем, будет ли Windows загружать список поставщиков для мастеров веб-публикации и онлайн-заказов
- **Обоснование:** Windows предотвращает загрузку поставщиков; отображаются только поставщики услуг, сохраненные в локальном реестре.

## 9. 5.11 — Обеспечение настройки «Служба Microsoft FTP (FTPSVC)» в значение «Отключено» или «Не установлено»
- **Статус:** FAIL
- **Ожидается:** 4 (Disabled)
- **Фактически:** `Параметр Start не найден в реестре (используется значение по умолчанию - Disabled or Not Installed)`
- **Ссылка:** HKLM\SYSTEM\CurrentControlSet\Services\FTPSVC:Start
- **Описание:** Позволяет серверу работать в качестве FTP-сервера (File Transfer Protocol).
- **Обоснование:** Размещение FTP-сервера (особенно незащищенного FTP-сервера) на рабочей станции представляет повышенный риск безопасности, так как поверхность атаки этой рабочей станции значительно увеличивается.

## 10. 18.5.11 —  Обеспечение настройки «MSS: (TcpMaxDataRetransmissions IPv6) Сколько раз повторно передаются неподтвержденные данные» в значение «Включено: 3»
- **Статус:** FAIL
- **Ожидается:** 3 (Enabled)
- **Фактически:** `Параметр TcpMaxDataRetransmissions не найден в реестре (используется значение по умолчанию - Disabled or Not Installed)`
- **Ссылка:** HKLM\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters:TcpMaxDataRetransmissions
- **Описание:** Этот параметр контролирует количество повторных передач TCP отдельного сегмента данных (неподключенного сегмента) перед прерыванием соединения.
- **Обоснование:** Злоумышленник может исчерпать ресурсы целевого компьютера, если он никогда не отправляет подтверждения для данных, переданных целевым компьютером.

## 11. 18.10.92.4.1 — Обеспечение настройки «Управление сборками предварительной оценки» в значение «Отключено»
- **Статус:** FAIL
- **Ожидается:** 1
- **Фактически:** `Параметр ManagePreviewBuildsPolicyValue не найден в реестре (используется значение по умолчанию - Отключено)`
- **Ссылка:** HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate:ManagePreviewBuildsPolicyValue
- **Описание:** Этот параметр политики управляет тем, какие обновления получаются до официального выпуска обновления.
- **Обоснование:** Разрешение экспериментальных функций в управляемой корпоративной среде может быть рискованным, поскольку это может привести к появлению ошибок и уязвимостей в системах, облегчая злоумышленнику получение доступа.

## 12. 9.3.9 — Обеспечение настройки «Брандмауэр Windows: Общедоступная: Ведение журнала: Регистрировать успешные подключения» в значение «Да»
- **Статус:** PASS
- **Ожидается:** 1
- **Фактически:** `Текущее значение: 1`
- **Ссылка:** HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate:ManagePreviewBuildsPolicyValue
- **Описание:** Используйте этот параметр, чтобы регистрировать случаи, когда Брандмауэр Windows в режиме повышенной безопасности разрешает входящее подключение. Журнал записывает, почему и когда было установлено подключение.
- **Обоснование:** Если события не записываются, может быть трудно или невозможно определить первопричину проблем системы или несанкционированные действия злоумышленников.

## 13. 18.10.9.3.11 — Обеспечение настройки «Настройка использования паролей для съемных дисков данных»
- **Статус:** PASS
- **Ожидается:** 0
- **Фактически:** `Текущее значение: 0`
- **Ссылка:** HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate:ManagePreviewBuildsPolicyValue
- **Описание:** Этот параметр политики позволяет указать, требуется ли пароль для разблокировки защищенных BitLocker съемных дисков данных.
- **Обоснование:** Этот параметр применяется при включении BitLocker, а не при разблокировке диска. BitLocker позволит разблокировать диск с помощью любого из доступных на диске средств защиты.

## 14. 18.9.4.2 — Обеспечение настройки «Удаленный узел разрешает делегирование неэкспортируемых учетных данных» в значение «Включено»
- **Статус:** FAIL
- **Ожидается:** 1
- **Фактически:** `Параметр AllowProtectedCreds не найден в реестре (используется значение по умолчанию`
- **Ссылка:** HKLM\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation:AllowProtectedCreds
- **Описание:** Удаленный узел разрешает делегирование неэкспортируемых учетных данных. При использовании делегирования учетных данных устройства предоставляют экспортируемую версию учетных данных удаленному узлу.
- **Обоснование:** Режим ограниченного администратора был разработан для защиты учетных записей администраторов путем обеспечения того, чтобы повторно используемые учетные данные не хранились в памяти на удаленных устройствах, которые потенциально могут быть скомпрометированы.

## 15. 18.10.9.2.5 — Обеспечение настройки «Выбор способа восстановления защищенных BitLocker дисков операционной системы: Пароль восстановления» в значение «Включено
- **Статус:** PASS
- **Ожидается:** 1
- **Фактически:** `Текущее значение: 1`
- **Ссылка:** HKLM\SOFTWARE\Policies\Microsoft\FVE:OSRecoveryPassword
- **Описание:** Этот параметр политики позволяет управлять способом восстановления защищенных BitLocker дисков операционной системы при отсутствии необходимой ключевой информации для запуска.
- **Обоснование:** В разделе «Настройка хранения пользователем информации для восстановления BitLocker» выберите, разрешено ли пользователям создавать 48-значный пароль восстановления или 256-битный ключ восстановления, требуется это или запрещено.

